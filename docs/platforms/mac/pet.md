# 桌面宠物功能

## 概述

桌面宠物是一个运行在 macOS App 中的交互式助手，提供：
- **实时任务状态**：自动反映运行中和等待中的任务
- **点击交互**：点击宠物显示操作菜单
- **Voice Wake 唤醒**：说 "Pet show" 或类似短语唤醒宠物
- **屏幕边缘显示**：固定在屏幕角落，不打扰工作区

## 使用方法

### 启用/禁用

1. 打开菜单栏 → 设置 → 宠物
2. 切换"启用宠物"开关

### 查看任务

- 点击宠物 → 选择"查看任务..."
- 或者使用快捷键 `Cmd+Shift+P`

### 切换宠物位置

1. 设置 → 宠物 → 位置
2. 选择：左上、右上、左下、右下

### Voice Wake 唤醒

默认唤醒词前缀：`Pet`

- "Pet show menu" - 显示宠物菜单
- "Pet work" - 强制进入工作状态
- "Pet rest" - 强制进入休息状态

### 状态说明

| 状态 | 视觉 | 含义 |
|------|------|------|
| **呼吸动画** | 透明度变化 | 无任务，休息中 |
| **弹跳动画** | 缩放变化 | 有任务执行中 |
| **摇晃动画** | 旋转变化 | 任务失败 |
| **灰色半透明** | 低透明度 | 未连接 |

### 任务徽章

- **绿色徽章**：显示运行中的任务数量
- **黄色徽章**：显示等待中的任务数量
- 无任务时不显示徽章

## 自定义宠物

默认提供以下宠物：
- **默认图标**：系统风格图标
- **弹跳球**：简单的弹跳动画

可通过安装扩展包添加自定义宠物（未来版本）。

## 故障排查

### 宠物不显示

1. 检查是否在设置中启用宠物
2. 检查 App 是否有麦克风权限（Voice Wake 需要）
3. 尝试重启 App

### 状态不同步

1. 检查 Gateway 连接状态
2. 查看日志：`log stream --predicate 'subsystem == "bot.molt" AND category CONTAINS "pet"' --level info`

### 动画卡死

1. 关闭并重新打开 App
2. 检查系统资源使用
3. 降低动画复杂度（使用简单图标宠物）
